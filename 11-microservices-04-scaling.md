
# Домашнее задание к занятию "11.04 Микросервисы: масштабирование"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развертывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Поддержка контейнеров;
- Обеспечивать обнаружение сервисов и маршрутизацию запросов;
- Обеспечивать возможность горизонтального масштабирования;
- Обеспечивать возможность автоматического масштабирования;
- Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.

Обоснуйте свой выбор.

## Задача 2: Распределенный кэш * (необязательная)

Разработчикам вашей компании понадобился распределенный кэш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster состоящий из трех шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)


# Ответ:

Для системы на основе микросервисной архитектуры я бы предложил использовать Kubernetes k8s и т.к. по условию компания крупная, есть ресурсы для запуска self-hosted решения, таким образом можно получить тонко насторенное под свои потребности решение и не быть привязаным к поставщикам managed решения. Kubernetes удовелетворяет всем поставленным условиям, т.к. является популярным решением для запуска микросервисов. 

#### Kubernetes:

- Поддерживает контейнеры: containerd, docker, cri-o.
- Обнаружение сервисов производится встроенным DNS - Kube-DNS. А маршрутизацию запросов обеспечивает kube-proxy.
- Выполняет горизонтальное автомасштабирование с помощью HorizontalPodAutoscaler (HPA), который автоматически развертывает больше подов при увеличении рабочей нагрузки (с учетом значений сервисных метрик).
- Автомасштабирование обеспечивается на двух уровнях, между которыми требуется координация.
  * Уровень pod'ов, включающий горизонтальное (Horizontal Pod Autoscaler, HPA) и вертикальное автомасштабирование (Vertical Pod Autoscaler, VPA). Это масштабирование имеющихся ресурсов для контейнеров.
  * Уровень кластера, которым управляет система автомасштабирования кластера (Cluster Autoscaler, CA), она увеличивает или уменьшает количество узлов внутри кластера.
- Обеспечивает явное разделение ресурсов доступных извне и внутри системы. В качестве API gateway предлагаю использовать Apache apisix, это позволит  удобный, гибкий в настройке высокоскоростной api шлюз.
- Обеспечивает возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п. Предлагаю дл рабоиты с секретами использовать HashiCorp Vault, это добавит удобство и безопасность.


---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
